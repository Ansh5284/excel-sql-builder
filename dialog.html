<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SQL Advanced Editor</title>

    <!-- Office JS -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <!-- Sortable JS (for dragging ingredients) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

    <link href="dialog.css" rel="stylesheet" type="text/css" />
</head>
<body>

    <!-- Header -->
    <div class="header">
        <div class="logo">üç≥ SQL Workbench</div>
        <div class="tabs">
            <div class="tab active" id="tab-visual" onclick="switchTab('visual')">Visual Joiner</div>
            <div class="tab" id="tab-sql" onclick="switchTab('sql')">Raw SQL</div>
        </div>
    </div>

    <!-- Workspace -->
    <div class="workspace">
        
        <!-- SIDEBAR (Ingredients) -->
        <div class="sidebar">
            <div class="sidebar-actions">
                <button class="btn-icon" id="btn-add-table"><span>üìÖ</span> Add Table</button>
                <button class="btn-icon" id="btn-add-calc"><span>∆íx</span> Add Calc</button>
                <button class="btn-icon btn-rel" id="btn-manage-rel">üîó Relationships</button>
            </div>
            
            <div class="tree-view" id="ingredients-list">
                <!-- Content will be injected by JS from TaskPane data -->
                <div class="placeholder-text">Loading Schema...</div>
            </div>
        </div>

        <!-- MAIN CANVAS (The Pan) -->
        <div class="main-area">
            
            <!-- VIEW 1: VISUAL JOINER -->
            <div id="view-visual" class="canvas-view" style="display:flex;">
                <div class="canvas-bg">
                    <!-- Visual Tables will be dropped here -->
                    <div class="empty-state">
                        Drag Tables here to start joining
                    </div>
                </div>
            </div>

            <!-- VIEW 2: SQL EDITOR -->
            <div id="view-sql" class="canvas-view" style="display:none; flex-direction:column;">
                <div class="editor-toolbar">
                    <button class="editor-btn">Format SQL</button>
                    <button class="editor-btn">Clear</button>
                </div>
                <textarea id="sql-editor-area" class="sql-area" placeholder="-- Type your advanced SQL here..."></textarea>
            </div>

        </div>

        <!-- RIGHT PANEL (Properties - Hidden by default) -->
        <div class="properties-panel" id="props-panel" style="display:none;">
            <h4>Properties</h4>
            <!-- Dynamic content for Join details -->
        </div>

    </div>

    <!-- FOOTER -->
    <div class="footer">
        <button class="btn btn-cancel" id="btn-close">Cancel</button>
        <button class="btn btn-primary" id="btn-apply">Run & Load to Excel</button>
    </div>

    <script src="dialog.js" type="text/javascript"></script>
</body>
</html>